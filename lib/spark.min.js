
(function($,progress,window){if($&&progress&&typeof window.spark==="undefined"){var jsdoUsername=null;var jsdoPassword=null;var jsdoSession=null;var optionDefaults={id:"",filterQuery:"",data:{},success:false,error:false};window.spark={field:{},form:{},grid:{},loader:{},nav:{},notify:{},jsdoFailure:function(jsdo,success,request){if(request.xhr&&request.xhr.status===401||request.xhr.status===403){if(window.spark.jsdoAuthError){window.spark.jsdoAuthError(request);}else{alert("Session has expired. Please login again.");}}else if(request.response&&request.response._errors&&request.response._errors.length>0){var errorMsg="";var lenErrors=request.response._errors.length;for(var idxError=0;idxError<lenErrors;idxError++){var errorEntry=request.response._errors[idxError];errorMsg=errorMsg+" "+errorEntry._errorMsg;}
if($.trim(errorMsg)!==""){console.warn(errorMsg);}}},createSession:function(serviceURI,catalogURI,authModel){if(!jsdoSession){jsdoSession=new progress.data.JSDOSession({authenticationModel:authModel||progress.data.Session.AUTH_TYPE_ANON,serviceURI:serviceURI||null});}
if(jsdoSession.loginResult!==progress.data.Session.LOGIN_SUCCESS){return jsdoSession.login(jsdoUsername||"anonymous",jsdoPassword||"").then(function(){jsdoSession.catalogLoaded={};jsdoSession.catalogLoaded[catalogURI]=false;return jsdoSession.addCatalog(catalogURI,jsdoUsername||"anonymous",jsdoPassword||"").then(function(session,result,responses){$.each(responses,function(i,response){jsdoSession.catalogLoaded[response.catalogURI]=(response.result?true:false);});return responses;});},function(){return"Unable to reach the REST adapter to establish a session.";});}else{var promise=$.Deferred();promise.resolve("loggedIn");return promise;}},createJSDO:function(resourceName){var jsdo=null;$.each(jsdoSession.JSDOs,function(i,j){if(j.name===resourceName){jsdo=j;return;}});return(jsdo||(new progress.data.JSDO({name:resourceName})));},setCredentials:function(username,password){jsdoUsername=username||null;jsdoPassword=password||null;},clone:function(originalProps,newProps){return $.extend(true,{},originalProps,newProps);},toProperCase:function(string){return string.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase();});},getJsdoSession:function(){return jsdoSession;},getMergedOptions:function(options){return this.clone(optionDefaults,options);},getQueryStringValue:function(key){var urlParams=window.location.search;if(urlParams===""){urlParams=window.location.href;}
return unescape(urlParams.replace(new RegExp("^(?:.*[&\\?]"+escape(key).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));},createJSDODataSource:function(resourceName,options){var jsdo=spark.createJSDO(resourceName);var jsdoProps=jsdo.getMethodProperties("read");var capabilities=[];if(jsdoProps&&jsdoProps.capabilities){capabilities=jsdoProps.capabilities.split(",");}
var defaults={serverFiltering:capabilities.indexOf("filter")>-1,serverPaging:capabilities.indexOf("top")>-1,serverSorting:capabilities.indexOf("sort")>-1,transport:{jsdo:jsdo},type:"jsdo"};if(options.tableRef){defaults.transport.tableRef=options.tableRef;delete options.tableRef;}
return new kendo.data.DataSource($.extend(defaults,options));},jsdo_read:function(jsdoObj,options){var promise=null;var filterQuery=options.filterQuery||"";if(filterQuery===""){promise=jsdoObj.fill();}else{promise=jsdoObj.fill(filterQuery);}
promise.done(function(jsdo,success,request){}).fail(this.jsdoFailure);return promise;},jsdo_create:function(jsdoObj,options){var currentRecord=options.data;var jsrecord=jsdoObj.add(currentRecord);var promise=jsdoObj.saveChanges();promise.done(function(jsdo,success,request){}).fail(this.jsdoFailure);return promise;},jsdo_update:function(jsdoObj,options,callback){var jsrecord=jsdoObj.findById(options.id);try{jsrecord.assign(options.data);}catch(e){options.error(null,null,e);}
var promise=jsdoObj.saveChanges();promise.done(function(jsdo,success,request){}).fail(this.jsdoFailure);return promise;},jsdo_delete:function(jsdoObj,options,callback){var jsrecord=jsdoObj.findById(options.id);try{jsrecord.remove();}catch(e){options.error(null,null,e);}
var promise=jsdoObj.saveChanges();promise.done(function(jsdo,success,request){}).fail(this.jsdoFailure);return promise;}};}})(jQuery,progress,window);(function($,window){if($&&typeof window.spark!=="undefined"){window.spark=$.extend(window.spark,{clearPersistentObject:function(key){var storage=window.localStorage||null;if(storage&&storage.clearObject){storage.clearObject(key);return true;}else if(storage){delete storage[key];return true;}else{this.setCookie(key,"");return true;}},setPersistentObject:function(key,value){var storage=window.localStorage||null;if(storage&&storage.getObject){storage.setObject(key,value);return true;}else if(storage){storage[key]=JSON.stringify(value);return true;}else{this.setCookie(key,JSON.stringify(value));return true;}},getPersistentObject:function(key){var storage=window.localStorage||null;if(storage&&storage.getObject){return storage.getObject(key);}else if(storage){var storageValue=storage[key];if(typeof(storageValue)==="string"){return JSON.parse(storageValue);}}else{var cookieValue=this.getCookie(key);if(typeof(cookieValue)==="string"){return JSON.parse(cookieValue);}}
return"";},clearSessionObject:function(key){var storage=window.sessionStorage||null;if(storage&&storage.clearObject){storage.clearObject(key);return true;}else if(storage){delete storage[key];return true;}
return false;},setSessionObject:function(key,value){var storage=window.sessionStorage||null;if(storage&&storage.getObject){storage.setObject(key,value);return true;}else if(storage){storage[key]=JSON.stringify(value);return true;}
return false;},getSessionObject:function(key){var storage=window.sessionStorage||null;if(storage&&storage.getObject){return storage.getObject(key);}else if(storage){var value=storage[key];if(typeof(storage[key])==="string"){return JSON.parse(value);}}
return"";},getCookie:function(key){var name=key+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1);if(c.indexOf(name)==0)return c.substring(name.length,c.length);}
return"";},setCookie:function(key,value,exdays){var d=new Date();d.setTime(d.getTime()+((exdays||1)*24*60*60*1000));var expires="expires="+d.toUTCString();document.cookie=key+"="+value+"; "+expires+"; path=/";}});}
if(window.Storage){Storage.prototype.clearObject=function(key,value){if(this.removeItem){this.removeItem(key);}};Storage.prototype.setObject=function(key,value){if(this.setItem){try{var jsonValue=JSON.stringify(value);this.setItem(key,jsonValue);}
catch(err){console.warn("Unable to store peristent object in DOM: "+err);console.warn("An error was encountered while storing data to the browser. Please view the ISC logs for details.");}}};Storage.prototype.getObject=function(key){if(this.getItem){return JSON.parse(this.getItem(key));}
return"";};}})(jQuery,window);if(window.spark&&jQuery&&kendo){window.spark.loader=(function($,kendo){return{loadExtScreen:function(rootPath,contentID,pageName,options){return $.ajax({dataType:"script",url:rootPath+".js",success:function(jsResult){return $.ajax({dataType:"html",url:rootPath+".html",success:function(htmlResult){kendo.destroy($("#"+contentID).children());$("#"+contentID).empty();$("#"+contentID).html(htmlResult);},error:function(result){alert("Error loading HTML file "+rootPath+".html");}});},error:function(result){alert("Error loading JavaScript file "+rootPath+".js");}});},loadExtInclude:function(filePath,contentID,modalName,options){return $.ajax({dataType:"html",url:filePath,success:function(htmlResult){kendo.destroy($("#"+contentID).children());$("#"+contentID).empty();$("#"+contentID).html(htmlResult);$("[data-toggle=tooltip]").tooltip();},error:function(result){alert("Error loading template file "+filePath);}});},loadExtTemplate:function(filePath,contentID,templateID,options){return $.ajax({dataType:"html",url:filePath,success:function(tmplResult){$("#"+contentID).append(tmplResult);var template=kendo.template($("#"+templateID).html());var htmlBody=template(options||{});kendo.destroy($("#"+contentID).children());$("#"+contentID).empty();$("#"+contentID).html(htmlBody);},error:function(result){alert("Error loading template file "+filePath);}});}};})(jQuery,kendo);}
if(window.spark&&jQuery&&kendo){window.spark.field={lookupTextField:"name",lookupValueField:"value",USStateList:["AL","AK","AS","AZ","AR","CA","CO","CT","DE","DC","FM","FL","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MH","MD","MA","MI","MN","MS","MO","MP","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PW","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY"],createDatePickerMDY:function(selector,options){if($(selector)){return $(selector).kendoDatePicker($.extend({format:"MM/dd/yyyy",parseFormats:["MM/dd/yyyy","MM/dd/yy","yyyy-MM-dd"]},options)).getKendoDatePicker();}
return null;},createFormattedPhone:function(selector,options){if($(selector)){return $(selector).kendoMaskedTextBox($.extend({mask:"(000) 000-0000"},options)).getKendoMaskedTextBox();}
return null;},createFormattedSSN:function(selector,options){if($(selector)){return $(selector).kendoMaskedTextBox($.extend({mask:"000-00-0000"},options)).getKendoMaskedTextBox();}
return null;},createMultiLookup:function(selector,options){if($(selector).length){return $(selector).kendoMultiSelect($.extend({autoClose:false,dataSource:new kendo.data.DataSource(),dataTextField:this.lookupTextField,dataValueField:this.lookupValueField,valuePrimitive:true},options)).getKendoMultiSelect();}
return null;},createSingleLookup:function(selector,options){if($(selector).length){return $(selector).kendoDropDownList($.extend({dataSource:new kendo.data.DataSource(),dataTextField:this.lookupTextField,dataValueField:this.lookupValueField,valuePrimitive:true},options)).getKendoDropDownList();}
return null;},createUSStateList:function(selector,options){if($(selector).length){return $(selector).kendoDropDownList($.extend({dataSource:this.USStateList,optionLabel:"Select",valuePrimitive:true},options)).getKendoDropDownList();}
return null;}};}
if(window.spark&&kendo){window.spark.form={getValidator:function(selector,options){if($(selector).length){if($(selector).getKendoValidator()&&!options){return $(selector).getKendoValidator();}
return $(selector).kendoValidator($.extend({},options)).getKendoValidator();}
return null;},validate:function(selector,options){var validator=this.getValidator(selector,options);if(validator){return validator.validate();}
return false;}};}
if(window.spark&&kendo){window.spark.grid={getSelectedRecord:function(event){var grid=event.sender;if(grid){return grid.dataItem(grid.select());}
return{};}};}
if(window.spark&&jQuery&&kendo){window.spark.io={addExtensionClass:function(extension){switch(extension){case".jpg":case".img":case".png":case".gif":return"fa fa-file-image-o fa-3x";case".doc":case".docx":return"fa fa-file-word-o fa-3x";case".xls":case".xlsx":return"fa fa-file-excel-o fa-3x";case".pdf":return"fa fa-file-pdf-o fa-3x";case".zip":case".rar":return"fa fa-file-zip-o fa-3x";default:return"fa fa-file-o fa-3x";}},createUpload:function(selector,uploadOptions,overrides){if($(selector)){return $(selector).kendoUpload($.extend({async:{autoUpload:uploadOptions.autoUpload||false,batch:uploadOptions.batchUpload||false,saveUrl:uploadOptions.saveURL||"upload",saveField:uploadOptions.saveField||"files"},enabled:uploadOptions.enableUpload||false,multiple:uploadOptions.multiUpload||false,showFileList:uploadOptions.showFileList||false,template:uploadOptions.template||null,cancel:uploadOptions.onCancel||null,complete:uploadOptions.onComplete||null,error:uploadOptions.onError||null,progress:uploadOptions.onProgress||null,success:uploadOptions.onSuccess||null,upload:uploadOptions.onUpload||null,select:uploadOptions.onSelect||null,remove:uploadOptions.onRemove||null},overrides)).getKendoUpload();}
return null;},};}
if(window.spark&&kendo){window.spark.nav=(function(kendo){return{createSimpleRouter:function(options){if(!options){options={};}
if(!options.mainContentID||options.mainContentID===""){options.mainContentID="mainContent";}
var router=new kendo.Router({change:options.onChange||function(ev){}});router.route("/",function(){var promise=jQuery.Deferred();if(options.getLandingPage){promise=options.getLandingPage();}else{promise.resolve("");}
promise.done(function(page){if(page!==""){var path=options.filePathPrefix+page;spark.loader.loadExtScreen(path,options.mainContentID,page).complete(function(){if(options.onLoad){options.onLoad(page,path);}});}else{if(options.onLoad){options.onLoad("");}}});});router.route("/logout",function(){spark.getJsdoSession().logout().then(function(){if(options.onLogout){options.onLogout();}});});router.route("/:page",function(page){var path=options.filePathPrefix+page;spark.loader.loadExtScreen(path,options.mainContentID,page).complete(function(){if(options.onLoad){options.onLoad(page,path);}});});router.route("/:sec/:page",function(sec,page){var path=options.filePathPrefix+sec+"/"+page;spark.loader.loadExtScreen(path,options.mainContentID,page).complete(function(){if(options.onLoad){options.onLoad(page,path,sec);}});});router.route("/:sec/:sub/:page",function(sec,sub,page){var path=options.filePathPrefix+sec+"/"+sub+"/"+page;spark.loader.loadExtScreen(path,options.mainContentID,page).complete(function(){if(options.onLoad){options.onLoad(page,path,sec,sub);}});});return router;}};})(kendo);}
if(window.spark&&jQuery&&kendo){window.spark.notify=(function($,kendo){var _notificationObj=null;return{setNotificationArea:function(selector,options){selector=selector||"#staticNotification";if($(selector).length){_notificationObj=$(selector).kendoNotification($.extend({appendTo:"#notificationArea",autoHideAfter:20000,button:true},options)).getKendoNotification();}else{_notificationObj=null;}
return _notificationObj;},showStaticNotification:function(message,type){if(_notificationObj){_notificationObj.show(message,type||"info");var container=$(_notificationObj.options.appendTo);if(container.length){container.scrollTop(container[0].scrollHeight);}}}};})(jQuery,kendo);}